// external iframe api
//script src='https://meet.jit.si/external_api.js'

// Here you can access Jitsi Meet API trough the ```JitsiMeetJS``` global object.
//script src="https://meet.jit.si/libs/lib-jitsi-meet.min.js"


//import React, { useState } from 'react'

import JitsiMeetExternalAPI from '../javascripts/jitsi/external_api';

class Conference {
    constructor() {
        this.api = undefined;
        this.domain = "meet.agil-verwirklichen.de";
        this.options = {
          roomName: "Klassenraum",
          width: "100%",
          height: 500,
          parentNode: document.querySelector("#meet"),
          configOverwrite: {},
          interfaceConfigOverwrite: {
          filmStripOnly: false
          },
          userInfo: {
            email: 'michael.schiller@gmx.de'
          }
        }

        document.getElementById('js-start-conference-0').addEventListener('click', ()=>{
            this.close()
            this.start(this.domain, "Klassenraum");
        });
        document.getElementById('js-start-conference-1').addEventListener('click', ()=>{
            this.close()
            this.start(this.domain, 'Gruppe 1');
        });
        document.getElementById('js-start-conference-2').addEventListener('click', ()=>{
            this.close()
            this.start(this.domain, 'Gruppe 2');
        });
        document.getElementById('js-start-conference-3').addEventListener('click', ()=>{
            this.close()
            this.start(this.domain, 'Gruppe 3');
        });
        //document.getElementById('js-stop-conference').addEventListener('click', ()=>{
        //    this.close()
        //});
        document.getElementById('js-toggle-chat').addEventListener('click', ()=>{
            this.api.executeCommand('toggleChat');
        });
        //document.getElementById('js-share-screen').addEventListener('click', ()=>{
        //    this.api.executeCommand('toggleShareScreen');
        //});
    }

    start(domain, room) {
      this.options.roomName = room + ' Klasse 2a ' + (new Date(Date.now())).toLocaleDateString();
      this.api = new JitsiMeetExternalAPI(domain, this.options);
    }

    close() {
      if(this.api) {this.api.executeCommand('hangup');}
      var iframe = document.getElementsByTagName("iframe")[0];
      if(iframe) {iframe.remove();}
    }
}

// autostart jitsi
const conference = new Conference();
conference.start("meet.agil-verwirklichen.de", 'Klassenraum');

export default (new Conference);
